import{g as j}from"../chunks/NQmCZVoA.js";import{K as I,S as H,i as N,s as O,n as P,d as _,b as M,c as m,m as v,e as p,f as b,o as z,h as A,j as g,k as S,l as V,a as B,L as y,g as G,t as q,M as K,w,v as k,y as J,N as Q,O as R,P as W,B as X,E as Y,G as Z,H as x,F as ee,x as te}from"../chunks/Euv9bMr_.js";import{a as E,i as ae}from"../chunks/DK1tR62X.js";import"../chunks/IHki7fMi.js";import{e as C,u as se,d as oe,r as T}from"../chunks/XT8gz2Jn.js";import{p as re}from"../chunks/DqI0N4dn.js";const le=async({url:i,fetch:e})=>{{const t=I(E),l=i.pathname;!t&&l!=="/login"&&await j("/login"),t&&l==="/login"&&await j("/")}const o=I(E);if(o)try{const t=await e("/api/devices",{headers:{Authorization:`Bearer ${o}`}});if(t.ok)return{devices:await t.json()}}catch(t){console.error("Gagal fetch devices di layout:",t)}return{devices:[]}},ve=Object.freeze(Object.defineProperty({__proto__:null,load:le},Symbol.toStringTag,{value:"Module"}));function U(i,e,o){const t=i.slice();return t[2]=e[o],t}function D(i,e){let o,t,l=e[2].toUpperCase()+"",a,u,s;return{key:i,first:null,c(){o=g("li"),t=g("a"),a=q(l),s=S(),this.h()},l(r){o=p(r,"LI",{});var n=b(o);t=p(n,"A",{href:!0,class:!0});var d=b(t);a=G(d,l),d.forEach(_),s=A(n),n.forEach(_),this.h()},h(){v(t,"href",u="/pm/"+e[2]),v(t,"class","block px-4 py-2 text-gray-600 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors duration-200"),y(t,"bg-gray-200",e[1].url.pathname.includes(`/pm/${e[2]}`)),y(t,"dark:bg-gray-700",e[1].url.pathname.includes(`/pm/${e[2]}`)),this.first=o},m(r,n){M(r,o,n),m(o,t),m(t,a),m(o,s)},p(r,n){e=r,n&1&&l!==(l=e[2].toUpperCase()+"")&&B(a,l),n&1&&u!==(u="/pm/"+e[2])&&v(t,"href",u),n&3&&y(t,"bg-gray-200",e[1].url.pathname.includes(`/pm/${e[2]}`)),n&3&&y(t,"dark:bg-gray-700",e[1].url.pathname.includes(`/pm/${e[2]}`))},d(r){r&&_(o)}}}function ne(i){let e,o,t='<h2 class="text-xl font-bold text-gray-800 dark:text-white">Power Meters</h2>',l,a,u,s=[],r=new Map,n=C(i[0].sort());const d=c=>c[2];for(let c=0;c<n.length;c+=1){let f=U(i,n,c),h=d(f);r.set(h,s[c]=D(h,f))}return{c(){e=g("aside"),o=g("div"),o.innerHTML=t,l=S(),a=g("nav"),u=g("ul");for(let c=0;c<s.length;c+=1)s[c].c();this.h()},l(c){e=p(c,"ASIDE",{class:!0});var f=b(e);o=p(f,"DIV",{class:!0,"data-svelte-h":!0}),z(o)!=="svelte-w687sj"&&(o.innerHTML=t),l=A(f),a=p(f,"NAV",{class:!0});var h=b(a);u=p(h,"UL",{});var L=b(u);for(let $=0;$<s.length;$+=1)s[$].l(L);L.forEach(_),h.forEach(_),f.forEach(_),this.h()},h(){v(o,"class","p-4 border-b dark:border-gray-700"),v(a,"class","mt-4 overflow-y-auto"),v(e,"class","w-64 bg-white dark:bg-gray-800 shadow-md p-4 flex flex-shrink-0 flex-col h-full")},m(c,f){M(c,e,f),m(e,o),m(e,l),m(e,a),m(a,u);for(let h=0;h<s.length;h+=1)s[h]&&s[h].m(u,null)},p(c,[f]){f&3&&(n=C(c[0].sort()),s=se(s,f,d,1,c,n,r,u,oe,D,null,U))},i:P,o:P,d(c){c&&_(e);for(let f=0;f<s.length;f+=1)s[f].d()}}}function ie(i,e,o){let t;V(i,re,a=>o(1,t=a));let{devices:l=[]}=e;return i.$$set=a=>{"devices"in a&&o(0,l=a.devices)},[l,t]}class ce extends H{constructor(e){super(),N(this,e,ie,ne,O,{devices:0})}}function F(i){let e,o;return e=new ce({props:{devices:i[0].devices}}),{c(){ee(e.$$.fragment)},l(t){x(e.$$.fragment,t)},m(t,l){Z(e,t,l),o=!0},p(t,l){const a={};l&1&&(a.devices=t[0].devices),e.$set(a)},i(t){o||(k(e.$$.fragment,t),o=!0)},o(t){w(e.$$.fragment,t),o=!1},d(t){Y(e,t)}}}function ue(i){let e,o,t,l,a=i[1]&&F(i);const u=i[3].default,s=K(u,i,i[2],null);return{c(){e=g("div"),a&&a.c(),o=S(),t=g("main"),s&&s.c(),this.h()},l(r){e=p(r,"DIV",{class:!0});var n=b(e);a&&a.l(n),o=A(n),t=p(n,"MAIN",{class:!0});var d=b(t);s&&s.l(d),d.forEach(_),n.forEach(_),this.h()},h(){v(t,"class","flex-1 p-4 md:p-6 lg:p-8 overflow-y-auto"),v(e,"class","flex h-screen")},m(r,n){M(r,e,n),a&&a.m(e,null),m(e,o),m(e,t),s&&s.m(t,null),l=!0},p(r,[n]){r[1]?a?(a.p(r,n),n&2&&k(a,1)):(a=F(r),a.c(),k(a,1),a.m(e,o)):a&&(te(),w(a,1,1,()=>{a=null}),J()),s&&s.p&&(!l||n&4)&&Q(s,u,r,r[2],l?W(u,r[2],n,null):R(r[2]),null)},i(r){l||(k(a),k(s,r),l=!0)},o(r){w(a),w(s,r),l=!1},d(r){r&&_(e),a&&a.d(),s&&s.d(r)}}}function fe(i,e,o){let t;V(i,ae,s=>o(1,t=s));let{$$slots:l={},$$scope:a}=e,{data:u}=e;return X(()=>{const s=E.subscribe(r=>{if(r){const d=`${location.protocol==="https:"?"wss:":"ws:"}//${location.host}/ws`;T.connect(d,r)}else T.close()});return()=>s()}),i.$$set=s=>{"data"in s&&o(0,u=s.data),"$$scope"in s&&o(2,a=s.$$scope)},[u,t,a,l]}class be extends H{constructor(e){super(),N(this,e,fe,ue,O,{data:0})}}export{be as component,ve as universal};
